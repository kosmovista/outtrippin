<% set_page_title("Trip to " + @itinerary.destination + " - OutTrippin") %>
<div class="row top">
  <div class="large-11 large-centered columns">
    <div class="row">
      <div class="large-12 columns">
        <%= render 'steps', step: 'launch', disable: %w() %>
        <h3 class="text-center primary">Next up, let's get to know each other!</h3>
        <div class="large-4 large-centered small-12 columns">
          <hr>
        </div>
      </div>
    </div>

    <%= form_for @itinerary_finalize, url: publish_itinerary_path, method: :put, html: { class: 'custom' } do |f| %>

    <div class="row">
      <div class="large-6 columns">
        <%= f.label :activity_budget, "What's your activity budget (per person, per day)?" %>
      </div>
      <div class="large-6 columns">
        <%= f.select :activity_budget, options_for_select(activity_budget_options) %>
      </div>
    </div>

    <div class="row">
      <div class="large-6 columns">
        <%= f.label :accommodation_budget, "What's your accommodation budget (per person, per night)?" %>
      </div>
      <div class="large-6 columns">
        <%= f.select :accommodation_budget, options_for_select(accommodation_budget_options) %>
      </div>
    </div>

    <div class="row">
      <div class="large-12 small-12 columns">
        <% if @itinerary_finalize.errors[:personality].empty? %>
        <%= f.label :personality, "What's your travel personality?" %>
        <% else %>
        <%= f.label :personality, "What's your travel personality? (#{@itinerary_finalize.errors[:personality][0]})" %>
        <% end %>
        <%= f.fields_for :personality do |personality| %>
        <ul class="small-block-grid-1 large-block-grid-3">
          <% @personalities.each do |k,v| %>
          <li><%= personality.check_box k, checked: (@itinerary_finalize.personality.blank? ? false : (@itinerary_finalize.personality.include?(k) ? true : false)) %><%= personality.label k, class: "cbox" %></li>
          <% end %>
        </ul>
        <% end %>
      </div>
    </div>

    <br />
    <br />
    <div class="row">
      <div class="large-6 columns">
        <%= f.label :must, "Things I absolutely must see/do:" %>
      </div>
      <div class="large-6 columns">
        <%= f.text_area :must, placeholder: "I want to visit a volcano, I've heard La Paz Waterfall gardens are amazing and I'd love to eat as much street food as possible.", class: "medium-textarea" %>
      </div>
    </div>

    <div class="row">
      <div class="large-6 columns">
        <%= f.label :avoid, "Stuff I'd really like to avoid:" %>
      </div>
      <div class="large-6 columns">
        <%= f.text_area :avoid, placeholder: "We want our accommodation to be with local people or small hotels, we're not resort people. Nothing super touristy.", class: "medium-textarea" %>
      </div>
    </div>


    <div class="row">
      <div class="large-6 columns">
        <%= f.label :details, "Any extra details or ideas?" %>
      </div>
      <div class="large-6 columns">
        <%= f.text_area :details, placeholder: "eg: My husband loves adventure so would like to hear your ideas for activities we can do. I love hiking and I'm a vegetarian.", class: "medium-textarea" %>
      </div>
    </div>

    <div class="row">
      <div class="large-6 columns">
        <%= f.label :email, "Send my tailored travel story ideas to:" %>
      </div>
      <div class="large-6 columns">
        <%= f.text_field :email, placeholder: "brilliant@awesome.com" %>
        <%= errors_for(@itinerary_finalize, :email) %>
      </div>
    </div>

    <div class="row">
      <div class="large-2 large-offset-10 small-12 columns">
        <%= f.submit "Start my story", class: "radius button expand right" %>
      </div>
    </div>

    <% end %>
  </div>
</div>

<%= content_for :body do %>
  <script>
  <% if current_user %>
    mixpanel.alias("<%= current_user.id %>");
  <% end %>
  mixpanel.track("Page Loaded", {"page": "Step 2: Finalize"});
  mixpanel.track_forms("#new_itinerary_finalize", "Finalized Trip");
</script>
<% end %>